
#prefix :      <http://localhost/> 
prefix color: <http://localhost/color#> 
prefix prop:  <http://localhost/property#> 
prefix type:  <http://localhost/type#>
prefix manufactory: <http://localhost/manufactory#> 
prefix o:     <http://localhost/oborudovanie#> 

SELECT ?оборудование ?питает ?питается ?управляет ?управляется ?цех WHERE { 
   ?place prop:type type:manufactory .
  ?place prop:title ?bb FILTER (?bb = "Механический")
  
  {
    ?a prop:type type:o .
    ?a prop:place ?place .
    ?a prop:title ?оборудование .
    ?a prop:powered ?bd .
    ?bd prop:place ?bbplace FILTER (?bbplace != ?place) .
    ?bbplace prop:title ?цех .
    ?bd prop:title ?питается
  } 
  UNION {
    ?a prop:type type:o .
    ?a prop:place ?place .
    ?a prop:title ?оборудование .
    ?bd prop:powered ?a .
    ?bd prop:place ?bdplace FILTER (?bdplace != ?place )
    ?bdplace prop:title ?цех .
    ?bd prop:title ?питает
  } 
  UNION {
    ?a prop:type type:o .
    ?a prop:place ?place .
    ?a prop:title ?оборудование .
    ?a prop:control ?bd .
    ?bd prop:place ?bdplace FILTER (?bdplace != ?place)
    ?bd prop:title ?управляет .
    ?bdplace prop:title ?цех
  } 
  UNION {
    ?a prop:type type:o .
    ?a prop:place ?place .
    ?a prop:title ?оборудование .
    ?bd prop:control ?a .
    ?bd prop:place ?bdplace FILTER (?bdplace != ?place)
    ?bdplace prop:title ?цех .
    ?bd prop:title ?управляется .

  }
}
